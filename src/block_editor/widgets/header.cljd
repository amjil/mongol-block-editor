(ns block-editor.widgets.header
  (:require
   ["package:flutter/material.dart" :as m]
   [cljd.flutter :as f]
   [block-editor.state :as state]))

(defn header [{:keys [size color index]}]
  (f/widget
   :watch [font-size (f/$ (f/<! state/font-size))]
   :let [gradient-colors (if color
                           [color color]
                           [m/Colors.grey.shade700
                            m/Colors.grey.shade800])
         margin-left (* font-size 0.89)]
   (m/ReorderableDragStartListener
    .index index
    .child (m/Container
            .width size
            .height size
            .margin (m/EdgeInsets.only .left margin-left)
            .decoration (m/BoxDecoration.
                         .shape m/BoxShape.circle
                         .gradient (m/LinearGradient.
                                    .begin m/Alignment.topLeft
                                    .end m/Alignment.bottomRight
                                    .colors gradient-colors)
                         .boxShadow [(m/BoxShadow
                                      .color (m/Colors.blueGrey)
                                      .blurRadius 8
                                      .offset (m/Offset. 0 2)
                                      .spreadRadius 1)])))))